# Qbris-Sheets

### License:
QBrisSheets Â© 2024 by Jakub Kosecki

### Description:
This project is focused to create unified and low cost library for previewing any MSExcell like document in web browser.

It uses `SheetJS/XLSX` library under the hood.

## examples

Examples can be shown in `/examples/vanilla` directory

## usage

In vanilla js, only you need is to: 

- create suitable container for viewer:

```html
<div id="tableContainerWrapper">
  <div id="tableContainer"></div>
</div>
```

With css: 

```css
#tableContainer {
  flex: 1;
  overflow: hidden;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}

#tableContainerWrapper {
  overflow: hidden;
  position: relative;
  width: 800px;
  height: 600px;
  max-height: 600px;
  margin-left: 100px;
  margin-top: 100px;
  border: black 1px solid;
}
```

You can ofcourse manipulate width and height of `containerWrapper`. What is important to left `overflow` and `position` of `tableContainerWrapper` as it is, and whole `tableContainer`.

Next you can import library as an module:

```html
<script type="module">
    import QbrisSheet from '../lib/QbrisSheets-esm.js'; // import
    const sheet = new QbrisSheet(); // Qbris class creation
    sheet.setContainer('#tableContainer'); // setting up main table container

    // add action to button for file load
    document.getElementById('loadLocalFile').addEventListener('click', async () => {
      await sheet.loadLocalFile(); // spanws file picker window
      await sheet.render(); // renders qbris
    });
  </script>
```

## options

Class `QbrisSheet` contains several setup options that you can provide to constructor as an object.

### handleError

```ts
{handleError: (error: Error) => void}
```

Provide this function to make custom error handler. Default is browsers `alert`. 
Change to empty function `() => {}` to ignore errors.

### containerSelector

```ts
{containerSelector: string}
```

Provide js selector for main container (in above example it will be: `#tableContainer`). Can be also provided by function `setContainer` later.

### renderFooter

```ts
{renderFooter: boolean}
```

Switch for footer rendering. Footer contains ui for switching spread sheets of file. 

### maxRows

```ts
{maxRows: number}
```

Setup's max rows number in document. Cant be higher than 2000;

### maxColumns

```ts
{maxColumns: number}
```

Setup's max columns number in document. Cant be higher than 338 (til MZ);

### renderOnlySheetRange

```ts
{renderOnlySheetRange: boolean}
```

Override's `maxRows` and `maxColumns` to level provided by loaded file;

### onLoading

```ts
{onLoading?: (isLoading: boolean) => void}
```

Function handler for loading. Can be used for spawning loading view.

### styles

```ts
{
  setles: {
    footerButton?: string;
    footerBar?: string;
    tableWrapperStyle?: string;
    tableStyle?: string;
    cellStyle?: string;
    tableHeaderStyle?: string;
  }
}
```

Style class selectors. Default styles can be overriten. For Default styles look at: `lib/QbrisSheets.css`

## Methods

### setErrorHandler

```ts
setErrorHandler(handler: (error: Error) => void): void;
```

Setsup error handler. Symilar like `constructor:options:handleError`

### setContainer

```ts
setContainer(containerSelector: string): void;
```

Setsup main sheet container. Symilar like `constructor:options:containerSelector`

### loadLocalFile

```ts
loadLocalFile(): Promise<void>;
```

Spawn file picker for document selection, then loads `WrokBook` it to memory;
Triggers `onLoading`.
`render` call needed!

### loadRemoteFile

```ts
loadRemoteFile(url: string): Promise<void>;
```

Loads `WrokBook` file from given url.
Triggers `onLoading`.
`render` call needed!

### unload

```ts
unload(): void
```

Unloads current `WrokBook`;

### jumpToSheet

```ts
jumpToSheet(sheetName: string): Promise<void>;
```

Loads sheet from workbook with given name; No `render` call needed!

### render

```ts
render(): Promise<void>;
```

Render view after `WrokBook` load




